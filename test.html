<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DES解密工具</title>
    <!-- 引入Bootstrap CSS -->
    <link href="https://cdn.bootcdn.net/ajax/libs/twitter-bootstrap/5.3.0/css/bootstrap.min.css" rel="stylesheet">
    <!-- 引入CryptoJS库 -->
    <script src="https://cdn.bootcdn.net/ajax/libs/crypto-js/4.1.1/crypto-js.min.js"></script>
    <style>
        .result-box {
            min-height: 100px;
            word-break: break-all;
            background-color: #f8f9fa;
            padding: 10px;
            border: 1px solid #dee2e6;
            border-radius: 4px;
        }
    </style>
</head>
<body>
    <div class="container mt-5">
        <div class="row justify-content-center">
            <div class="col-md-8">
                <div class="card">
                    <div class="card-header">
                        <h3 class="text-center">DES解密工具</h3>
                    </div>
                    <div class="card-body">
                        <div class="form-group">
                            <label for="encryptedText" class="form-label">加密文本：</label>
                            <textarea id="encryptedText" class="form-control" rows="4" placeholder="请输入需要解密的文本"></textarea>
                        </div>
                        <button onclick="decrypt()" class="btn btn-primary mt-3">解密</button>
                        <div class="mt-3">
                            <label class="form-label">解密结果：</label>
                            <div id="result" class="result-box"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        function decrypt() {
            try {
                const encryptedText = document.getElementById('encryptedText').value;
                if (!encryptedText) {
                    alert('请输入需要解密的文本');
                    return;
                }

                // 密钥和IV
                const key = 'consmkey';
                const iv = CryptoJS.enc.Hex.parse('123456789091CDEF');

                // Base64解码
                const encryptedBytes = CryptoJS.enc.Base64.parse(encryptedText);

                // 创建DES解密配置
                const cfg = {
                    mode: CryptoJS.mode.CBC,
                    padding: CryptoJS.pad.Pkcs7,
                    iv: iv
                };

                // 解密
                const decrypted = CryptoJS.DES.decrypt(
                    { ciphertext: encryptedBytes },
                    CryptoJS.enc.Utf8.parse(key),
                    cfg
                );

                // 转换结果
                const decryptedText = decrypted.toString(CryptoJS.enc.Utf8);
                
                document.getElementById('result').innerText = decryptedText || '解密结果为空';
            } catch (error) {
                document.getElementById('result').innerText = '解密错误: ' + error.message;
            }
        }
    </script>
</body>
</html>
